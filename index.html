<!DOCTYPE html>
<html>
  <head>
    <title>Paul's Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  
  <body>
    <div id="map"></div>
    <script src="https://cdn.firebase.com/js/client/2.3.2/firebase.js"></script>
    
    <!-- <script src="https://www.gstatic.com/firebasejs/5.8.3/firebase.js"></script> -->

    <!-- <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCoDY3NqEEwREguYtaojAIMWT3W2mel5sw",
        authDomain: "sunny-equinox-229415.firebaseapp.com",
        databaseURL: "https://sunny-equinox-229415.firebaseio.com",
        projectId: "sunny-equinox-229415",
        storageBucket: "sunny-equinox-229415.appspot.com",
        messagingSenderId: "670236205578"
      };
      firebase.initializeApp(config);
    ;
    </script> -->
    
    
    <script>

      var firebase = new Firebase("https://sunny-equinox-229415.firebaseio.com/");

      /**
       * Data object to be written to Firebase.
       */
      //  var firebase = new Firebase("https://spatialform.firebaseio.com");

        function initMap() {
          var map = new google.maps.Map(document.getElementById('map'), {
            center: {
              lat: 39.6017,
              lng: -110.7970
            },
            zoom: 14,
            styles: [{
              featureType: 'poi',
              stylers: [{
                  visibility: 'off'
                }] // Turn off points of interest.
            }, {
              featureType: 'transit.station',
              stylers: [{
                  visibility: 'off'
                }] // Turn off bus stations, train stations, etc.
            }],
            disableDoubleClickZoom: false
          });
          map.addListener('click', function(e) {
            firebase.push({
              lat: e.latLng.lat(),
              lng: e.latLng.lng()
            });
            var marker = new google.maps.Marker({
              position: {
                lat: e.latLng.lat(),
                lng: e.latLng.lng()
              },
              map: map
            });
          });

          firebase.on("child_added", function(snapshot, prevChildKey) {
            var newPosition = snapshot.val();
            var latLng = new google.maps.LatLng(newPosition.lat,
              newPosition.lng);
            var marker = new google.maps.Marker({
              position: latLng,
              map: map
            });
          });
        }
        google.maps.event.addDomListener(window, "load", initMap);
    
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBTtMjivtMGiX2P1xZVLwJibqfFfS5mJvI&callback=initMap"
    async defer></script>
  </body>
</html>